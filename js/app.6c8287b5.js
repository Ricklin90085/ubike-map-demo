(function(t){function e(e){for(var a,o,s=e[0],u=e[1],l=e[2],d=0,p=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&p.push(i[o][0]),i[o]=0;for(a in u)Object.prototype.hasOwnProperty.call(u,a)&&(t[a]=u[a]);c&&c(e);while(p.length)p.shift()();return n.push.apply(n,l||[]),r()}function r(){for(var t,e=0;e<n.length;e++){for(var r=n[e],a=!0,s=1;s<r.length;s++){var u=r[s];0!==i[u]&&(a=!1)}a&&(n.splice(e--,1),t=o(o.s=r[0]))}return t}var a={},i={app:0},n=[];function o(e){if(a[e])return a[e].exports;var r=a[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=t,o.c=a,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(r,a,function(e){return t[e]}.bind(null,a));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/ubike-map-demo/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],u=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var c=u;n.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"3cde":function(t){t.exports=JSON.parse('[{"sort":1,"id":"0000","name":"臺北市","districts":[{"sort":10,"id":1,"name":"中正區","latitude":25.044214,"longitude":121.524725,"zipCode":100},{"sort":12,"id":2,"name":"大同區","latitude":25.066128,"longitude":121.51558,"zipCode":103},{"sort":2,"id":3,"name":"中山區","latitude":25.064449,"longitude":121.533668,"zipCode":104},{"sort":8,"id":4,"name":"松山區","latitude":25.049878,"longitude":121.577233,"zipCode":105},{"sort":4,"id":5,"name":"大安區","latitude":25.026511,"longitude":121.534346,"zipCode":106},{"sort":11,"id":6,"name":"萬華區","latitude":25.035047,"longitude":121.499776,"zipCode":108},{"sort":5,"id":7,"name":"信義區","latitude":25.033427,"longitude":121.566911,"zipCode":110},{"sort":7,"id":8,"name":"士林區","latitude":25.092897,"longitude":121.519771,"zipCode":111},{"sort":6,"id":9,"name":"北投區","latitude":25.132377,"longitude":121.502949,"zipCode":112},{"sort":1,"id":10,"name":"內湖區","latitude":25.06936,"longitude":121.588996,"zipCode":114},{"sort":9,"id":11,"name":"南港區","latitude":25.054527,"longitude":121.606793,"zipCode":115},{"sort":3,"id":12,"name":"文山區","latitude":24.989503,"longitude":121.5702,"zipCode":116}]}]')},"56d7":function(t,e,r){"use strict";r.r(e);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"app"}},[r("div",{staticClass:"row no-gutters"},[r("div",{staticClass:"toolbox col-sm-3 p-2 bg-white"},[r("div",{staticClass:"form-group d-flex"},[r("label",{staticClass:"col-form-label mr-2 text-right",attrs:{for:"city"}},[t._v("縣市")]),r("div",{staticClass:"flex-fill"},[r("select",{directives:[{name:"model",rawName:"v-model",value:t.cityName,expression:"cityName"}],staticClass:"form-control",attrs:{id:"city"},on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.cityName=e.target.multiple?r:r[0]}}},t._l(t.cityData,(function(e){return r("option",{key:e.id,domProps:{value:e.name}},[t._v(" "+t._s(e.name)+" ")])})),0)])]),r("div",{staticClass:"form-group d-flex"},[r("label",{staticClass:"col-form-label mr-2 text-right",attrs:{for:"dist"}},[t._v("地區")]),r("div",{staticClass:"flex-fill"},[r("select",{directives:[{name:"model",rawName:"v-model",value:t.district,expression:"district"}],staticClass:"form-control",attrs:{id:"dist",placeholder:"請選擇區域"},on:{change:[function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.district=e.target.multiple?r:r[0]},t.updateMarkers]}},[r("option",{attrs:{value:"",disabled:""}},[t._v(" 請選擇區域 ")]),t._l(t.cityData.find((function(e){return e.name===t.cityName})).districts,(function(e){return r("option",{key:e.id,domProps:{value:e}},[t._v(" "+t._s(e.name)+" ")])}))],2)])])]),t._m(0)])])},n=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"col-sm-9"},[r("div",{attrs:{id:"map"}})])}],o=(r("99af"),r("4de4"),r("4160"),r("d81d"),r("b0c0"),r("b64b"),r("159b"),r("96cf"),r("1da1")),s=r("e11e"),u=r.n(s),l=r("3cde"),c={name:"App",data:function(){return{userPos:[],cityData:l,cityName:"臺北市",district:"",bikeData:[],map:null,yourMarker:null,bikeMarkers:[]}},computed:{ubikes:function(){var t=this,e=this.bikeData.filter((function(e){return e.sarea===t.district.name}));return e}},created:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get("https://tcgbusfs.blob.core.windows.net/blobyoubike/YouBikeTP.json");case 2:r=e.sent,a=r.data,t.bikeData=Object.keys(a.retVal).map((function(t){return a.retVal[t]}));case 5:case"end":return e.stop()}}),e)})))()},mounted:function(){this.getPos()},methods:{getPos:function(){var t=this;navigator.geolocation.getCurrentPosition((function(e){t.userPos=[e.coords.latitude,e.coords.longitude],t.initMap()}))},initMap:function(){this.map=u.a.map("map",{center:this.userPos,zoom:16}),u.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>'}).addTo(this.map),this.yourMarker=u.a.marker(this.userPos).addTo(this.map).bindPopup("<b>你</b>").openPopup()},updateMarkers:function(){var t=this;this.removeMarkers(),this.bikeMarkers=this.ubikes.map((function(e){return u.a.marker([e.lat,e.lng]).addTo(t.map).bindPopup('<p><strong style="font-size: 20px;">'.concat(e.sna,'</strong></p>\n          <strong style="font-size: 16px; color: #d45345;">可租借車輛剩餘：').concat(e.sbi," 台</strong><br>\n          可停空位剩餘: ").concat(e.bemp,"<br>\n          <small>最後更新時間: ").concat(e.mday,"</small>"))})),this.moveMap()},removeMarkers:function(){var t=this;this.bikeMarkers.forEach((function(e){t.map.removeLayer(e)}))},moveMap:function(){this.map.flyTo([this.district.latitude,this.district.longitude],14)}}},d=c,p=(r("5c0b"),r("2877")),f=Object(p["a"])(d,i,n,!1,null,null,null),m=f.exports,v=r("bc3a"),b=r.n(v),h=r("a7fe"),g=r.n(h);r("21b6");a["a"].use(g.a,b.a),a["a"].config.productionTip=!1,new a["a"]({render:function(t){return t(m)}}).$mount("#app")},"5c0b":function(t,e,r){"use strict";var a=r("9c0c"),i=r.n(a);i.a},"9c0c":function(t,e,r){}});
//# sourceMappingURL=app.6c8287b5.js.map